# running_bitseq

#install
git clone https://github.com/BitSeq/BitSeq.git
cd Bitseq
make

---

#Make tr file from gtf file with:
print "#", "M", 14712
for line in open("Anopheles-coluzzii-Mali-NIH_BASEFEATURES_AcolM1.2.gtf"):
    i=line.strip().split()
    if line[0]=="#":
        continue
    if i[2]!="transcript":
        continue
    tr = i[-1].strip(";").strip('"')
    gene = tr.strip("-RA")
    L=int(i[4]) - int(i[3]) +1
    print gene, tr, L
> Acol_genes.tr    

---
#test command - pre-processing
BitSeq/parseAlignment Mopti-T3-YY_S189.sam -o Mopti-T3-YY_S189.prob --trSeqFile Anopheles-coluzzii-Mali-NIH_TRANSCRIPTS_AcolM1.2.fa --trInfoFile Acol_genes.tr --uniform --verbose

#sampling
BitSeq/estimateExpression Mopti-T3-YY_S189.prob -o Mopti-T3-YY_S189 --outType RPKM -p parameters1.txt -t Acol_genes.tr-NEW -P 2

#compute the mean and variance:
BitSeq/getVariance -o Mopti-T3-YY_S189.mean Mopti-T3-YY_S189.rpkm

#high-throughput
#Mopti
for file in Mopti*sam
do
BitSeq/parseAlignment $file -o $(basename $file .sam).prob --trSeqFile Anopheles-coluzzii-Mali-NIH_TRANSCRIPTS_AcolM1.2.fa --trInfoFile Acol_genes.tr-NEW --uniform --verbose
BitSeq/estimateExpression $(basename $file .sam).prob -o $(basename $file .sam) --outType RPKM -p parameters1.txt -t Acol_genes.tr-NEW -P 2
BitSeq/getVariance -o $(basename $file .sam).mean $(basename $file .sam).rpkm
done

#cyp1
for file in cyp1*sam
do
BitSeq/parseAlignment $file -o $(basename $file .sam).prob --trSeqFile Anopheles-coluzzii-Mali-NIH_TRANSCRIPTS_AcolM1.2.fa --trInfoFile Acol_genes.tr-NEW --uniform --verbose
BitSeq/estimateExpression $(basename $file .sam).prob -o $(basename $file .sam) --outType RPKM -p parameters1.txt -t Acol_genes.tr-NEW -P 2
BitSeq/getVariance -o $(basename $file .sam).mean $(basename $file .sam).rpkm
done
